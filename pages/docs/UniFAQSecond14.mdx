### 问题: 怎样获知重启前的snapshot信息和重启后的snapshot信息包含哪些内容
解决方案: 可以查看slog.conf文件,level值决定了slog获取内容的范围,level值为6以下含6为手机在正常运行过程中发生anr或者tombstone后抓取的信息,level值大于7含7,会在重启后获取. #type name opt level inter action snap meminfo file 6 300 /proc/meminfo snap slab file 6 300 /proc/slabinfo snap buddy file 6 300 /proc/buddyinfo snap slog_conf file 6 300 /data/local/tmp/slog/slog.conf snap cpu_usage file 9 300 /sys/kernel/debug/sprd_debug/cpu/cpu_usage snap traces file 7 0 /da
完整回答请参考FAQ: FAQ58577
### 问题: SC7715如何设置默认首选安装位置
解决方案: 1. 首先要确定\device\sprd\scx15\emmc\emmc_device.mk下STORAGE_INTERNAL和STORAGE_PRIMARY配置成什么 STORAGE_INTERNAL := physical STORAGE_PRIMARY := external 2. 根据STORAGE_INTERNAL和STORAGE_PRIMARY的配置找到对应init.storage1.rc、init.storage2.rc、init.storage3.rc或者init.storage4.rc,修改setprop persist.storage.type 2,如果是系统内置空间则改为1 private static final int APP_INSTALL_AUTO = 0; private static final int APP_INSTALL_DEVICE = 1; pr
完整回答请参考FAQ: FAQ58581
### 问题: SC7715可动态切换主WCDMA卡版本如何屏蔽切换功能
解决方案: 1. 此修改仅适用于MocorDroid4.4_3.10_7715_P14.30.2_P7及其后续版本,且modem版本为MOCORTM_14A_W14.41_P14.51及其后续版本 2. frameworks\base\telephony\java\android\telephony\TelephonyManager.java文件中 if(isDualW){ return MODEM_TYPE_WCDMA; } 改为 if(0 == phoneId){ return MODEM_TYPE_WCDMA; } 3. packages\services\Telephony\src\com\android\phone\MobileNetworkSettings.java 将所有 else if(1==mPhoneId){ settingsNetworkMode = android.provid
完整回答请参考FAQ: FAQ58682
### 问题: 如何判断vmlinux和log是否匹配
解决方案: 用文本工具或UltraEdit打开vmlinux,搜索字符串(注意是大写) Linux version,可以搜到类似Linux version 3.10.17 (root@driver-HP) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Thu Dec 4 23:43:22 CST 2014,里面有编译时的时间.或者在linux下运行下面命令 strings vmlinux | grep "Linux version" Linux version 3.10.17 (root@driver-HP) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Thu Dec 4 23:43:22 CST 2014 可以在kenenl log中搜索 Linux version Linux version 3.10.17 (root@driv
完整回答请参考FAQ: FAQ58716
### 问题: 使用ActivityManager的getMemoryInfo查看内存
解决方案: 使用ActivityManager的getMemoryInfo(ActivityManager.MemoryInfo outInfo) ActivityManager.getMemoryInfo()主要是用于得到当前系统剩余内存的及判断是否处于低内存运行. 实例1: private void displayBriefMemory() { final ActivityManager activityManager = (ActivityManager) getSystemService(ACTIVITY_SERVICE); ActivityManager.MemoryInfo info = new ActivityManager.MemoryInfo(); activityManager.getMemoryInfo(info); Log.i(tag,"系统剩余内存:"+(info.avail
完整回答请参考FAQ: FAQ58762
### 问题: Native 内存查看
解决方案: 使用Debug的getNativeHeapSize (),getNativeHeapAllocatedSize (),getNativeHeapFreeSize ()方法. 该方式只能得到Native堆的内存大概情况,数据单位为字节. static long getNativeHeapAllocatedSize() Returns the amount of allocated memory in the native heap. 返回的是当前进程navtive堆中已使用的内存大小 static long getNativeHeapFreeSize() Returns the amount of free memory in the native heap. 返回的是当前进程navtive堆中已经剩余的内存大小 static long getNativeHeapSize() Returns
完整回答请参考FAQ: FAQ58766
### 问题: tp中断下半部修改为单线程工作队列
解决方案: 在kernel中有一个主工作队列,这个主工作队列对每一个CPU都有效,很多中断的下半部都是直接让加入到这个主工作队列来执行,但由于TP是需要实时响应的,如果其他线程的提交的work数据处理卡住,后面的work就一直会不执行,所以如果TP以work方式读取数据,前面work卡的话,将导致TP无法读取数据,不能往上层报点,直到TP的work恢复正常为止. 这里提供的方法是使用单线程工作队列,这个队列一般建立在cpu0上,只给TP执行下半部.这样就能解决TP由于其他事情卡住而很久都不能报点的情况,因为cpu是每10ms被调度一次,再怎么多任何理论上也不会等太久也会被调度到. 优点:Kthread方式的读取TP数据,是以一个独立的线程进行读取,并且KTHREAD线程的优先级和work方式优先级别是一样高的,而inux系统线程的调度间隔10ms执行一次,即使其他线程卡住,也只会卡10ms,过了10m
完整回答请参考FAQ: FAQ58775
### 问题: Android 结束进程的几种方法
解决方案: 第一种方法: 主要适合api Level<=7 1 ActivityManager am = (ActivityManager)getSystemService(ACTIVITY_SERVICE); 2 am.restartPackage("com.android.music"); 并且需要在Manifest里面注册权限 1 <!-- API Level7及以下使用的 --> 2 <uses-permission android:name="android.permission.RESTART_PACKAGES"/> 第二种方法: 主要适合API Level>=8使用 1 ActivityManager am = (ActivityManager)getSystemService(ACTIVITY_SERVICE); 2 am.killBackgroundProcesses("com.an
完整回答请参考FAQ: FAQ58769
### 问题: L2CAP服务原语介绍
解决方案: 1. 事件指示:用于在选中事件发生时请求回呼; 2.连接:用于创建一条与物理地址对应的逻辑链路; 3. 连接响应:用于对连接请求(L2CA_ConnectInd)事件发送响应,在收到回呼指示后; 4. 配置:用于请求配置信道参数,发出L2CA_ConfigReg消息; 5. 配置响应:用于响应配置请求事件; 6. 断开连接:用于请求断开信道连接; 7. 写:用于请求通过信道传输数据; 8. 读:用于请求接收数据; 9. 创建组:用于请求创建一个代表与多个设备逻辑相连的CID; 10. 关闭组:用于关闭一个组; 11. 添加组成员:用于请求增加一个组成员; 12. 删除组成员:用于请求从组中删除一个成员; 13. 查询组成员:用于请求组成员的报告; 14. Ping:表示发出L2CA_EchoReg消息并接收对应的L2CA_EchoRsp消息; 15. GetInfo:用于表示发出L2CA_
完整回答请参考FAQ: FAQ58761
### 问题: 利用Java的反射机制结束Android进程
解决方案: ActivityManager am = (ActivityManager)getSystemService(ACTIVITY_SERVICE); try { Method forceStopPackage = am.getClass().getDeclaredMethod("forceStopPackage", String.class); forceStopPackage.setAccessible(true); forceStopPackage.invoke(am, "com.android.mms");//com.android.mms是要结束进程的包名 } catch (SecurityException e) { e.printStackTrace(); } catch (IllegalArgumentException e) { // TODO Auto-generated 
完整回答请参考FAQ: FAQ58773
### 问题: 在android中如何使应用程序成为桌面
解决方案: 使一般的应用程序成为桌面其实很简单,只需要在AndroidManiManifest.xml文件中添加如下红色代码即可: <activity android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen" android:name="com.test.launcher" android:label="@string/app_name" > <intent-filter> <action android:name="android.intent.action.MAIN" /> <category android:name="android.intent.category.HOME" /> <category android:name="android.intent.category.LAUNCHER" /> <cat
完整回答请参考FAQ: FAQ58780
### 问题: zygote的堆栈dump方法
解决方案: 实际上zygote 堆栈 dump可以同时dump java线程及native线程的堆栈,对于java线程,java堆栈和native堆栈都可以得到. 使用方法很简单,直接在adb shell或串口中输入: kill -3 <pid> 输出的trace会保存在 /data/anr/traces.txt文件中.这个需要注意,如果没有 /data/anr/这个目录或/data/anr/traces.txt这个文件,需要手工创建一下,并设置好读写权限. 如果需要在代码中,更容易控制堆栈的输出时机,可以用以下命令获取zygote的core dump: Process.sendSignal(pid, Process.SIGNAL_QUIT); 原理和命令行是一样的. 不过需要注意两点: 1.adb shell可能会没有权限,需要root. 2.android 4.2中关闭了native thread
完整回答请参考FAQ: FAQ58870
### 问题: 进入Camera为什么灭屏时间与系统设置时间不一致？
解决方案: 进入Camera后,Camera应用会设置屏幕常亮,2分钟后再灭屏. 设置屏幕常亮在VideoModule.keepScreenOnAwhile()方法中 PhotoModule.onResumeTasks() --> keepScreenOnAwhile() private void keepScreenOnAwhile() { mHandler.removeMessages(CLEAR_SCREEN_DELAY); mActivity.getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); //设置屏幕常亮的flag mHandler.sendEmptyMessageDelayed(CLEAR_SCREEN_DELAY, SCREEN_DELAY); //延迟一定时间后再灭屏 } SCREEN_DELA
完整回答请参考FAQ: FAQ59019
### 问题: [SC7731]添加新的语言添加后不显示，进入设置显示空白
解决方案: 添加新的语言步骤: android4.4增加一种语言的做法: 1)4.4的编译多语版本需要添加MULTILANGUAGE_SUPPORT=true即编译命令为 $source buile/envsetup.sh $lunch $kheader $MULTILANGUAGE_SUPPORT=true make 2)Setting中语言列表中可显示 1)修改文件位置为device/sprd/xxxx/xxxx.mk (xxxx为需要编译的对应项目) 修改PRODUCT_LOCALES字段值,添加要增加语言的5字符code 编码值,例:PRODUCT_LOCALES := en_US zh_CN,添加支持越南语,越南语编码为vi_VN,则PRODUCT_LOCALES的值为:PRODUCT_LOCALES := en_US zh_CN vi_VN 2)修改系统资源目录(framework/bas
完整回答请参考FAQ: FAQ59079
### 问题: 系统默认时间如何修改
解决方案: 系统默认时间修改如下: 1、kernel/arch/arm/configs/下面对应的defconfig文件里面有定义CONFIG_RTC_START_YEAR CONFIG_RTC_START_YEAR 改成2014 2、kernel/drivers/rtc/rtc-sprd.c 以下code有三处要统一修改成 mktime(CONFIG_RTC_START_YEAR, 8, 1, 0, 0, 0); 3、修改了kernel的默认时间,应用层相应的也要修改: packages/apps/Settings/src/com/android/settings/timerpower/Alarms.java private static void alarm_flag_setup(final long alarmTimeInMillis){ ........ c.set(2012, 0, 1, 0
完整回答请参考FAQ: FAQ70676
### 问题: 浏览器成功下载图片后，从download应用中打开图片，提示无法打开。
解决方案: [1.Root Cause ]: 1)从抓包内容看到,返回的报文Content-Type字段的内容是有双引号的: HTTP/1.1 200 OK X-Powered-By: PHP/5.3.6 Content-Type: "image/jpeg" 2)从log中也能看到.下载的图片,插入数据库时,其mimitype值为"image/jpeg",多出了外面的双引号,导致图库中判断出错. 01-06 10:44:20.380 1761 1761 I Controller: onDownloadStart mimeType "image/jpeg" 01-06 10:44:20.380 1761 1761 I DownLoadHandler: onDownloadStart--mimeType=="image/jpeg" url==http://image.baidu.com/i?tn=down
完整回答请参考FAQ: FAQ59775
### 问题: 为什么在Android平台上以MR\MRS等为前缀的联系人排序时不以字母"M"为索引？
解决方案: 这个是google的默认逻辑设计,只有在英语环境下才会对名称的前缀和后缀做相关特殊处理,在其他语言下正常. 具体如下: 1. 进入contacts app,新建一个联系人; 2. 在联系人姓名栏输入如下类似字段(目前已知): Class 1: common_name_prefixes 1LT , 1ST , 2LT, 2ND, 3RD, ADMIRAL, CAPT, CAPTAIN, COL, CPT, DR, GEN, GENERAL, LCDR, LT, LTC, LTG, LTJG, MAJ, MAJOR, MG, MR, MRS, MS, PASTOR, PROF, REP, REVEREND, REV, SEN, ST Class 2: common_name_suffixes B.A. , BA , D.D.S. , DDS , I, II, III, IV, IX, JR.,
完整回答请参考FAQ: FAQ59832
### 问题: 如何使相机中睡眠时间与系统设置的时间一致？
解决方案: 仅需要把PhotoModule.java中的SCREEN_DELAY设置为0即可 --- a/src/com/android/camera/PhotoModule.java +++ b/src/com/android/camera/PhotoModule.java @@ -153,7 +153,7 @@ public class PhotoModule // needed to be updated in mUpdateSet. private int mUpdateSet; - private static final int SCREEN_DELAY = 2 * 60 * 1000; + private static final int SCREEN_DELAY = 0;//2 * 60 * 1000; private int mZoomValue; // The current zo
完整回答请参考FAQ: FAQ59928
### 问题: 分辨率为16:9的照片在图库中查看为何会显示压缩？
解决方案: 在图库网格中显示的图片是根据图片Exif中自带的缩略图信息获得的,而拍照时Camera没有设置缩略图的大小,所以底层默认为320x240,对于16:9的照片生成的缩略图会是压缩的. 修改方案:拍照时根据picture size如果为16:9,则设置比例为16:9的缩略图 在PhotoModule.updateCameraParametersPreference()方法中修改. // Set picture size. String pictureSize = mPreferences.getString(CameraSettings.KEY_PICTURE_SIZE, null); if (pictureSize == null) { CameraSettings.initialCameraPictureSize(mActivity, mParameters); } else { List
完整回答请参考FAQ: FAQ59932
### 问题: 浏览器中输入大写的百度网址WWW.BAIDU.COM无法打开，如何修改
解决方案: 原因是原生framework中的Pattern.URL不识别大写 解决方案: WEB_URL加入Pattern.CASE_INSENSITIVE 将frameworks/base/core/java/android/util/Patterns.java文件中WEB_URL的值修改如下: public static final Pattern WEB_URL = Pattern.compile( "((?:(http|https|Http|Https|rtsp|Rtsp):\\/\\/(?:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)" + "\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,64}(?:\\:(?:[a-zA-Z0-9\\$\\-\\_" + "\\.\\+\\!\\*\\'\\(\\)\\,\\;
完整回答请参考FAQ: FAQ60717
### 问题: 如何修改浏览器主页为空白页
解决方案: [解决方案] 修改对应的homepage_base定义,改成 about:blank. diff --git a/res/values/strings.xml b/res/values/strings.xml old mode 100644 new mode 100755 index 4276f93..8930341 --- a/res/values/strings.xml +++ b/res/values/strings.xml @@ -800,7 +800,7 @@ <!-- The default homepage. --> <string name="homepage_base_cucc" translatable="false"> http://www.wo.com.cn</string> //如果客户的是CUCC版本,请改这里 <string name="homepage_ba
完整回答请参考FAQ: FAQ60833
### 问题: 如何在应用中禁止状态栏(StatusBar)下拉扩展？
解决方案: 在Activity的onResume()方法中,禁止状态栏扩展 StatusBarManager mStatusBarManager = (StatusBarManager)getSystemService("statusbar"); mStatusBarManager.disable(StatusBarManager.DISABLE_EXPAND); 在Activity的onPause()方法中,恢复状态栏可以扩展 StatusBarManager mStatusBarManager = (StatusBarManager)getSystemService("statusbar"); mStatusBarManager.disable(StatusBarManager.DISABLE_NONE); 否则,退出应用后,状态栏也不能扩展了. 最后,需要在AndroidManifest.xml
完整回答请参考FAQ: FAQ60892
### 问题: 输入框行尾，怎样才能允许输入空格自动换行？
解决方案: 安卓原生对文字的换行策略是: 在正式的文件中每行开头不能是标点、空格等非常规字符 修改原生策略前,需要考虑以下几点: 1、这个需求是否合理,修改与不修改对不同的用户群不同场景下会造成什么影响,是否某些用户及场景下用户体验增加了,但另一些却降低了. 2、修改原生策略有可能会造成一些 CTS 相关 case fail. 3、对整个系统的原有界面会有影响,之前合适的地方在修改后换行位置变了,可能变得会有显示问题. 修改方法是: frameworks/base/core/java/android/text/StaticLayout.java的generate方法中: 搜索:boolean isSpaceOrTab = c == CHAR_TAB || c == CHAR_ZWSP; 修改为:boolean isSpaceOrTab = c == CHAR_SPACE || c == CHAR_TA
完整回答请参考FAQ: FAQ60957
### 问题: 在本地视频播放时，如何灰化“参数设置”选项?
解决方案: 视频播放器中的"参数设置"选项主要是针对流媒体播放进行设置的,如果播放本地视频时,需要灰化"参数设置"选项,请按照如下代码进行修改即可. modified: packages/apps/Gallery2/src/com/android/gallery3d/app/MovieActivity.java --- a/src/com/android/gallery3d/app/MovieActivity.java +++ b/src/com/android/gallery3d/app/MovieActivity.java @@ -404,6 +404,12 @@ public class MovieActivity extends Activity { /** SPRD: add for CMCC feature @{ */ mMenu = menu; MenuItem playbackMenu
完整回答请参考FAQ: FAQ61095
### 问题: 在视频播放器中为什么actionbar为空？
解决方案: 正常情况下,视频播放器中都会有设置actionbar的,但是如果遇到视频播放时没有actionbar的情况,我们可以去查找一下对应的资源文件下的styles.xml 的设置,例如: \packages\apps\Gallery2\res\values-v11\styles.xml ,其中就没有设置actionbar,具体设置之处如下面的红色字体部分, 具体内容如下: <?xml version="1.0" encoding="utf-8"?> <!-- Copyright (C) 2012 The Android Open Source Project Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the 
完整回答请参考FAQ: FAQ61220
### 问题: 如何实现将uboot阶段读取电池电压传递到kernel使用
解决方案: 具体实现的步骤如下: (1) 在uboot阶段通过接口ADC的ADC_GetValue (u-boot\arch\arm\cpu\armv7\sc8830\Adc.c) 接口函数读取这时的VBAT通道ADC_CHANNEL_VBAT的ADC值,然后在creat_cmdline(\u-boot\property\normal_mode.c) 把该值添加到cmdline(也可以把ADC值转换成电压之后再添加到cmdline) (2)在kernel阶段通过在充电代码Sprd_2713_power.c (kernel\drivers\power) 添加类似下面函数读取cmdline传递过来的ADC值: unsigned int adc_value_uboot = 0; static int __init adc_get_uboot(char *str) { char *charge_data = 
完整回答请参考FAQ: FAQ61222
### 问题: DDR 配置
解决方案: 以1PCS 4Gb的DDR修改方法为例: 1、chipram\include\configs\sp7731gea_hd.h: //#define DDR_LPDDR1 #define DDR_LPDDR2 //根据DDR类型选择其中一个 //#define DDR_DDR3 //#define DDR_AUTO_DETECT //关掉 #define DDR_TYPE DRAM_LPDDR2_1CS_4G_X32 //根据DDR类型选择其中一个 //#define DDR_TYPE DRAM_LPDDR2_1CS_8G_X32 //#define DDR_TYPE DRAM_LPDDR2_2CS_8G_X32 //#define DDR_TYPE DRAM_LPDDR2_2CS_16G_X32 2、u-boot\include\configs\sp7731gea_hd.h: #define
完整回答请参考FAQ: FAQ61282
### 问题: Google预编译库源码的获取的方法
解决方案: 当我们需要Google预编译库源码时,可以在android.googlesource.com网站上获取到源码. 下面以tradefed-prebuilt.jar库为例,说明获取其源码的方法: 1. 一般Google在预编译库的目录下会有一个PREBUILT文件,里面指明了源码的路径,编译时使用的版本. The object in this prebuilt directory can be rebuilt from platform/tools/tradefederation From the revision 2ea6ede0de42f52ddfb595586e7abd0dfb5f2f48 2. 到android.googlesource.com拉取源码,并取出编译时使用的版本.Google无法访问时可以尝试使用代理,如export https_proxy=http://10.0.2.9
完整回答请参考FAQ: FAQ61350
### 问题: 如何添加浏览器预置导航网址
解决方案: 预置Digicel ,Google ,YouTube , Wikipedia的参考代码如下: 1.\src\com\android\browser\provider\BrowserProvider2.java public void onCreate(SQLiteDatabase db) { ……………… //增加黄色背景代码 addDefaultNavigations(db); enableSync(db); createOmniboxSuggestions(db); } private void addDefaultNavigations(SQLiteDatabase db) { Resources res = getContext().getResources(); CharSequence[] navigations = res.getTextArray( R.array.navi
完整回答请参考FAQ: FAQ61378
### 问题: 在视频播放过程中，如何隐藏 播放/暂停 按钮？
解决方案: 当视频播放时,点击视频播放区域除播放/暂停按钮之外的区域,播放/暂停 按钮会隐藏,再次点击则又显示出来,请参考如下sample code 进行修改即可. --- a/src/com/android/gallery3d/app/MovieControllerOverlay.java +++ b/src/com/android/gallery3d/app/MovieControllerOverlay.java @@ -33,7 +33,7 @@ public class MovieControllerOverlay extends CommonControllerOverlay implements AnimationListener { private boolean hidden; - + private boolean menuHidden = false; private final 
完整回答请参考FAQ: FAQ61473
### 问题: 7731 LPDDR3配置方法
解决方案: 7731 IDH包中默认代码多数是LPDDR2的,只要是展讯平台认证过的DDR3的物料,一般只需要修改下面描述中1这一条就可以支持了.但是由于很多客户多个项目使用同一套代码,支持不同的DDR配置,代码被修改过 ,所以需要检查2,3,4,5项是否正确.常见问题是下面提到的配置项配置错误或者修改了下述中没有提到的其它配置. 4Gb的DDR修改方法如下: 1、配置内存主频,选择类型,文件位置chipram\include\configs\sp7731gea_hd.h: #define DDR_FREQ 500000000 //#define DDR_LPDDR1 #define DDR_LPDDR3 //支持LPDDR3 //#define DDR_DDR3 #define DDR_AUTO_DETECT // // #define DDR_TYPE DRAM_LPDDR2_1CS_4G_X32
完整回答请参考FAQ: FAQ61491
### 问题: 播放1080P视频或是比特率大的视频出现无法播放
解决方案: 当播放1080P视频或是比特率大的视频出现无法播放, 如果出现以后log: 01-01 12:49:41.105 166 1471 E OMXCodec: [OMX.sprd.h264.decoder] Codec's input buffers are too small to accomodate buffer read from source (info->mSize = 393216, srcLength = 513289) 代表此视频有些Frame Size过大, 超出平台所预设将frame读取上来的buffer size, 然后报错. 可以修改frameworks中的decoder initPorts()的def.nBufferSize参数来更改input buffer size. 通常会有这样的情形发生, 大概都是以下几种情况: 1. 1080P片源 2. 比特率很大的片源 
完整回答请参考FAQ: FAQ62034
### 问题: google play下载报错, 错误代码927
解决方案: google play下载应用软件发生错误时通常会弹出如上图的错误讯息, 也可以从log里找到google play相关的错误log. D Finsky : [1] 2.onErrorResponse: Received VolleyError 927 发生927错误主要源自于几种原因 1. google play软件自身正在更新, 所以无法下载应用软件. 遇到此情况可先等待google play软件更新完成, 再做操作, 如果问题还是持续发生, 可至设置->应用->全部找到Google服务框架, Google Play服务与Google Play商店, 点击清除数据与清除缓存并强行停止, 再开启google play商店测试. 2. google帐号与google服务器在联系上出现了问题 遇到此情形请先去设置移除google帐号, 至设置->应用->全部找到Google服务框架, Goo
完整回答请参考FAQ: FAQ61652
### 问题: 如何添加HALL SWITCH功能？
解决方案: 下面举例说明添加HALL SWITCH功能步骤: 现与gpio194为例 设计一个hall key键 (1)底层驱动的修改 在按键驱动的probe函数里(/kernel/drivers/input/keyboard/sc_keypad.c) #define KEY_HALL 249 //添加新按键键值 __set_bit(KEY_HALL, input_dev->keybit); //input设备上报 gpio_request(194, "hallkey"); //申请GPIO和中断 gpio_direction_input(194); error = request_irq(gpio_to_irq(194), sci_hallkey_isr,IRQF_TRIGGER_LOW | IRQF_NO_SUSPEND, "hallkey", sci_kpd); enable_irq(gpio_
完整回答请参考FAQ: FAQ61909
### 问题: 如何监听屏亮或屏灭？
解决方案: 1、注册Receiver,监听Intent.ACTION_SCREEN_OFF和Intent.ACTION_SCREEN_ON private void registerScreenActionReceiver() { final IntentFilter filter = new IntentFilter(); filter.addAction(Intent.ACTION_SCREEN_OFF); filter.addAction(Intent.ACTION_SCREEN_ON); registerReceiver(mReceiver, filter); } 2、接收Intent.ACTION_SCREEN_OFF和Intent.ACTION_SCREEN_ON并处理: private final BroadcastReceiver mReceiver = new BroadcastRe
完整回答请参考FAQ: FAQ61864
### 问题: 长按button的回调函数和短按button的回调函数有什么不同？
解决方案: 短按button的回调函数如下: //frameworks\base\core\java\android\view\view.java /** * Interface definition for a callback to be invoked when a view is clicked. */ public interface OnClickListener { /** * Called when a view has been clicked. * * @param v The view that was clicked. */ void onClick(View v);//在onClick()中需要添加监听短按操作需要实现的功能. } 长按button的回调函数如下: //frameworks\base\core\java\android\view\view.java /** *
完整回答请参考FAQ: FAQ61882
### 问题: PC工具执行恢复出厂设置功能，工具提示成功，手机没有执行恢复出厂的操作。
解决方案: 该问题主要是与SEAndroid开启相关,抓取log的时候如果发现有如下类似信息就说明与之有关: avc: denied { rename } for pid=193 针对该问题的解决方案如下: 请在engpc.te中作如下修改,然后重新全编尝试,自测试在正常开机和校准模式使用mobiletester发送at命令都是可行的. --allow engpc engpc:capability { sys_nice dac_override dac_read_search }; ++allow engpc engpc:capability { sys_nice dac_override dac_read_search sys_boot }; ++allow engpc cache_file:dir { write open create read add_name remove_name rmdi
完整回答请参考FAQ: FAQ66704
### 问题: [android 4.4]如何使得自带的视频播放器固定为横屏播放，且自动翻转？
解决方案: android:screenOrientation="landscape" 是只固定横屏显示且不翻转,如果视频播放器需要固定为横屏显示,且横屏翻转,请在androidmainfest.xml中相应位置增加语句: android:screenOrientation="sensorLandscape" ,例如如下修改: 修改文件路径:/packages/apps/Gallery2/AndroidManifest.xml diff --git a/AndroidManifest.xml b/AndroidManifest.xml --- a/AndroidManifest.xml +++ b/AndroidManifest.xml @@ -64,6 +64,7 @@ <!-- SPRD: add icon @{ --> <activity android:name="com.android.ga
完整回答请参考FAQ: FAQ62279
### 问题: 2723芯片背光灯控制
解决方案: pwm_level = (pwm_level + 1) & PWM_MOD_MAX; if(led_level > 0x3F); led_level = 0x3F; printk("[white led] led_level = %d pwm_level = %d\n" , led_level,pwm_level); reg_val = sci_adi_read(WHTLED_CTL); reg_val &= ~(0x3F << 1); reg_val |= led_level << 1; sci_adi_raw_write(WHTLED_CTL, reg_val); #ifdef SERIES_MODE_EN /*series mode*/ /*whiteled config*/ //WHTLED_V_MSK >=6 min 5mA step 0.625mA /*enable the w
完整回答请参考FAQ: FAQ66701
### 问题: 合入widevine函数库, 开机发生service died问题
解决方案: 观察log通常会有native crash, 原因是碰到二进制兼容性的问题, 以libwvm.so为例, libwvm 参考到 libstagefright 和 libstagefright_foundation, 如果libstagefright vtable与原始libwvm.so所参考的libstagefright vtable不同, 就有机率发生此现象. 01-04 00:11:09.294 169 169 I DEBUG : backtrace: 01-04 00:11:09.294 169 169 I DEBUG : #00 pc 0000352c /system/lib/libcutils.so (android_atomic_inc+8) 01-04 00:11:09.294 169 169 I DEBUG : #01 pc 0000d075 /system/lib/lib
完整回答请参考FAQ: FAQ62650
### 问题: 如何透过Android.mk将档案拷贝至system内
解决方案: Android里透过编写mk将档案拷贝进system内, 有三种方法. 1.透过PRODUCT_COPY_FILES 例: PRODUCT_COPY_FILES +=\ vendor/tts/test.so:system/tts/test.so 意思是指将vendor/tts下的test.so拷贝至system/tts/底下. 2. include $(BUILD_PREBUILT) 例: include $(CLEAR_VARS) LOCAL_MODULE := Test LOCAL_MODULE_TAGS := optional LOCAL_SRC_FILES := $(LOCAL_MODULE).apk LOCAL_MODULE_CLASS := APPS LOCAL_MODULE_PATH := $(TARGET_OUT)/vendor/app include $(BUILD_PR
完整回答请参考FAQ: FAQ62703
### 问题: MP4 片源中 STBL(Sample Table Box) Box 内容为空时, 如何修正此问题？
解决方案: 原因: 一个有效的 mp4 track Box, 需要检查其 stbl(Sample Table Box) Box 中有无 chunk offset, size, time等资讯, 当MPEG4Extractor检查到没有这些资讯, 则往上报错提示无法播放此视频. 解决方法: 1. parse 过程, moov -> trak -> mdia -> mdhd 到 mdhd box 时, timescale 值为 1000, 但 duration 值为0, 那么 track 长度 duration/time scale = 0/1000 = 0, 再把 mLastTrack->durationUs 的值记录起来为0 2. 当继续往下 parse moov -> trak -> mdia -> minf -> stbl 到 stbl container box 时, 里面没有其它子box (t
完整回答请参考FAQ: FAQ63012
### 问题: GTS 测试InjectedSettingTestCase为什么失败？
解决方案: 此测项主要会执行三个检查, 依照先后顺序为 1. 检查Settings-> Location Location Services 内是否有Google Location Reporting图示及此字串, 如果没有,则会出现报"Google Location Reporting' never showed up"错误讯息 2. 点击Google Location Reporting, 如果点击失败,会出现"Clicking on Google Location Reporting failed" 错误讯息 3.检查点击Google Location Reporting进去画面ActionBar title 字串是否为Google location settings 如果检查失败,则会出现"click should have launched Google location settings.
完整回答请参考FAQ: FAQ63008
### 问题: [android4.4]阿拉伯语下视频播放界面的快进/快退图标反的?
解决方案: 因为阿拉伯语默认为排列顺序是从右到左,所以视频播放器中的播放控制按钮playControllerView对包含的5个控制按钮也是从右到左排列,因此快进/快退图标显示位置相反了,请在\packages\apps\Gallery2\src\com\android\gallery3d\app\CommonControllerOverlay.java 中的playControllerView.setClickable(true)下面增加如下一行playControllerView.setLayoutDirection(LAYOUT_DIRECTION_LTR);设置playControllerView的排列顺序为从左到右:LAYOUT_DIRECTION_LTR --- a/src/com/android/gallery3d/app/CommonControllerOverlay.java +++
完整回答请参考FAQ: FAQ63533
### 问题: 7731平台LPDDR3方案软件如何配置
解决方案: 一、硬件需要按展讯SP7731G-4方案设计,并确保硬件电源仿真、信号仿真PASS 二、软件配置方法 前提条件:如果当前是PhaseI版本未合入过lpddr3驱动支持patch,则需要先合入PATCH00154554(注意AP和Modem均有更新);如果是PhaseII版本或PhaseI版本已合入lpddr3驱动支持patch,则继续做如下配置: 1. chipram配置 chipram/include/configs/projectname.h #define DDR_FREQ 500000000 /*7731 LPDDR3 6层板硬件设计的DDR主频跑500M,4层板建议跑400M*/ //#define DDR_LPDDR2 /*此宏关闭*/ #define DDR_LPDDR3 /*此宏开启*/ #define DDR_AUTO_DETECT /*此宏定义必须打开,下面的具体类型宏
完整回答请参考FAQ: FAQ63261
### 问题: 阿拉伯语/波斯语等语言布局如何从右往左的显示
解决方案: 要实现RTL(从右到左)的布局镜面反射,仅仅需要遵循下列步骤就可以做到: 1. 在应用程序声明文件(manifest)里声明开启RTL mirroring的支持.具体做法是:在manifest.xml声明文件的<application>元素中,添加 android:supportsRtl="true" 2. 修改应用程序中所有的"left/right"布局属性,改为对应的"start/end"布局 1)如果应用程序是针对Android 4.2目标平台(应用的targetSdkVersion或者minSdkVersion是17或者更高), 那么应当用"start"和"end"替换原来的"left"和"right".例如,android:paddingLeft应当被替换为android:paddingStart. 2) 如果想让应用程序与Android 4.2之前的版本保持兼容(也就是与tar
完整回答请参考FAQ: FAQ63579
### 问题: 浏览器在手机终端重启后或关闭进程后,如何修改直接进入主页
解决方案: 修改packages\apps\Browser\src\com\android\browser\Controller.java 把currentTabId=mTabControl.canRestoreState(icicle, restoreIncognitoTabs) 改为currentTabId=-1, void doStart(final Bundle icicle, final Intent intent) { ………… final boolean restoreIncognitoTabs = !(lastActiveDate == null || lastActiveDate.before(yesterday) || lastActiveDate.after(today)); // Find out if we will restore any state and remembe
完整回答请参考FAQ: FAQ63589
### 问题: EAP-SIM EAP-AKA 测试方法
解决方案: EAP-SIM EAP-AKA 测试方法 测试步骤如下: 手机端:使用gen_sim_db可以生车hostapd那边hlr_auc_gw所需的SIM相关配置文件,使用步骤如下 1. 确保手机卡槽1插入了SIM卡 2. 把附件工具push到手机中,直接执行(在adb shell下直接敲gen_sim_adb,不带参数) 3. SIM相关信息会生成为/data/misc/wifi/hostapd.test_sim_db,直接放到hostapd那边使用就可以了 该文件的内容大致格式如下 # IMSI:KC:SRES:RAND 460000383136976:92AE74C354047000:5D966AB6:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 460000383136976:7A7F4EBBF2DE7400:A3B5DFC5:BBBBBBBBBBBBBBBBBBBB
完整回答请参考FAQ: FAQ63761
### 问题: testSimpleGeolocationRequestAcceptAlways和testSimpleGeolocationRequestAcceptOnce测试FAIL？
解决方案: android.webkit.cts.GeolocationTest#testSimpleGeolocationRequestAcceptAlways android.webkit.cts.GeolocationTest#testSimpleGeolocationRequestAcceptOnce 这两个测试项目在测试过程中要获取地理位置信息,室内测试打开GPS无效,需要通过网络定位支持,必须预置第三方Networklocation(百度、高德、GMS),Networklocation_Baidu预置流程如下: (1)预置Baidu定位apk和so:附件Baidu.zip(/ishare/uploadeditor/file/20150420/20150420203818_744.zip)解压后,将Baidu目录放到vendor\sprd\partner\Baidu,参与编译; (2)修改:
完整回答请参考FAQ: FAQ63906
### 问题: 蓝牙芯片不支持BLE，怎么在CTS Verify中去掉相关测试项？
解决方案: 去掉Bluetooth Low Energy所有测试项,修改:frameworks\base\core\java\android\app\ApplicationPackageManager.java +import android.os.Bundle; @Override public List<ResolveInfo> queryIntentActivities(Intent intent, int flags) { - return queryIntentActivitiesAsUser(intent, flags, mContext.getUserId()); + + if ("com.android.cts.verifier".equals(mContext.getPackageName())) { + List<ResolveInfo> sourceList = queryInt
完整回答请参考FAQ: FAQ63965
### 问题: testActivateGoodReceiverDisplaysActivationUi测试FAIL？
解决方案: 安装CtsDeviceAdmin.apk之后,在设备管理器增加3个待激活项: android.deviceadmin.cts.CtsDeviceAdminReceiver android.deviceadmin.cts.CtsDeviceAdminReceiver2 android.deviceadmin.cts.CtsDeviceAdminDeactivatedReceiver CTS测试前,前面两个要激活,后面一个不要激活;因为测试时检查第三项是否处于DeActive状态,如果激活会打印如下错误堆栈: 04-17 15:01:06 I/0123456789ABCDEF: android.admin.cts.DeviceAdminActivationTest#testActivateGoodReceiverDisplaysActivationUi FAIL junit.framework
完整回答请参考FAQ: FAQ63966
### 问题: CTS测试报告中的Device Information如何去掉Root Processes的refnotify项？
解决方案: refnotify需要root权限,是因为自动下载过程中需要执行reboot系统调用,而这个"版本自动下载"功能,仅用于自动测试烧写版本,量产版本可直接改为system,注意UID和GID都要改,修改方法: diff --git a/scx35/init.sc8830.rc b/scx35/init.sc8830.rc index 2feff5e..c672eaf 100755 --- a/scx35/init.sc8830.rc +++ b/scx35/init.sc8830.rc @@ -437,12 +437,14 @@ service slog /system/bin/slog -t service refnotify_td /system/bin/refnotify -t 0 class main disabled - user root + user system + grou
完整回答请参考FAQ: FAQ64003
### 问题: com.android.cts.appsecurity.AppSecurityTests#testPermissionDiffCert测试偶现FAIL
解决方案: 从CTS保存的logcat中,看到如下错误堆栈: 03-20 00:51:58.342 12477 12489 I TestRunner: failed: testGrantAmbiguousNonGrantingFail(com.android.cts.usespermissiondiffcertapp.AccessPermissionWithDiffSigTest) 03-20 00:51:58.342 12477 12489 I TestRunner: ----- begin exception ----- 03-20 00:51:58.352 12477 12489 I TestRunner: 03-20 00:51:58.352 12477 12489 I TestRunner: java.lang.RuntimeException: Timeout 03-20 00:51:58
完整回答请参考FAQ: FAQ64004
### 问题: android.app.cts.AlarmManagerTest#testAlarmTriggersImmediatelyIfSetTimeIsNegative测试偶现FAIL
解决方案: 错误堆栈显示超时: I/TestRunner( 2314): failed: testAlarmTriggersImmediatelyIfSetTimeIsNegative(android.app.cts.AlarmManagerTest) I/TestRunner( 2314): ----- begin exception ----- I/TestRunner( 2314): I/TestRunner( 2314): junit.framework.AssertionFailedError: unexpected timeout I/TestRunner( 2314): at junit.framework.Assert.fail(Assert.java:50) I/TestRunner( 2314): at android.cts.util.PollingCheck.run(Polli
完整回答请参考FAQ: FAQ64005
### 问题: CTS如何计算屏幕的DPI？
解决方案: (1)CTS的做法是直接通过DisplayMetrics取值: DisplayMetrics metrics = new DisplayMetrics(); WindowManager wm = (WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE); Display d = wm.getDefaultDisplay(); d.getRealMetrics(metrics); addResult(RESOLUTION, String.format("%sx%s", metrics.widthPixels, metrics.heightPixels)); addResult(SCREEN_DENSITY, metrics.density); addResult(SCREEN_X_DENSITY, metric
完整回答请参考FAQ: FAQ64098
### 问题: 新建邮件username不可编辑，如何修改？
解决方案: user name不可编辑的问题,是为了防止用户错误输入, 可编辑需要修改package\app\Email\src\com\android\email\activity\setup\AccountSetupIncomingFragment.java onCreateView 函数中的180行 // We're editing an existing account; don't allow modification of the user name if (mSettingsMode) { makeTextViewUneditable(mUsernameView, getString(R.string.account_setup_username_uneditable_error)); } else { makeTextViewUneditable(mUsernameView, getS
完整回答请参考FAQ: FAQ64309
### 问题: 预置了两个浏览器，需要在开机时设置一个缺省的浏览器，怎样修改？
解决方案: 如果手机本身安装了多个浏览器而又没有设置默认浏览器的话,系统将让用户选择使用哪个浏览器来打开连接. 修改方法是设置默认程序使用packageManager.addPreferredActivity() 请在frameworks\base\services\core\java\com\android\server\pm\PackageManagerService.java中的systemReady函数的最后中增加以下代码. if (isFirstBoot()) { String str1 = "android.intent.category.DEFAULT"; String str2 = "android.intent.category.BROWSABLE"; String str3 = "android.intent.action.VIEW"; // 设置默认项的必须参数之一,用户的操作符
完整回答请参考FAQ: FAQ64307
### 问题: Google认证要求CVE-2014-3566安全更新，怎样合入？
解决方案: CVE-2014-3566更新方法: (1)拿到google提供的patch,打patch顺序: Apply 0001-Add-support-for-TLS_FALLBACK_SCSV.patch to platform/libcore Apply 0001-Fix-Early-CCS-bug to platform/external/openssl ///////////////// 这个patch来自 CVE-2014-0224,要在0002-Add-support-for-TLS_FALLBACK_SCSV.patch之前patch Apply 0002-Add-support-for-TLS_FALLBACK_SCSV.patch to platform/external/openssl Apply 0001-SCSV-support.patch to platform/exte
完整回答请参考FAQ: FAQ64341
### 问题: 新浪、QQ等邮箱登录不上，如何修改？
解决方案: 原因是这些邮箱默认设置有变动, qq邮箱需要用imap方式登录,新浪邮箱POP3网址有变化, 请做如下修改: packages/apps/Email/res/xml/providers.xml <provider id="qq" label="qq" domain="qq.com"> - <incoming uri="pop3://pop.qq.com" username="$email" /> - <outgoing uri="smtp://smtp.qq.com" username="$email" /> + <incoming uri="imap+ssl+://imap.qq.com" username="$email" /> + <outgoing uri="smtp+ssl+://smtp.qq.com" username="$email" /> </provider> <pro
完整回答请参考FAQ: FAQ64315
### 问题: android.net.cts.DnsTest#testDnsWorks测试FAIL
解决方案: android.net.cts.DnsTest#testDnsWorks FAIL junit.framework.AssertionFailedError at android.net.cts.DnsTest.testDnsWorks(DnsTest.java:86) at java.lang.reflect.Method.invokeNative(Native Method) at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:191) at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:176) at android.test.InstrumentationTestRunner.onStart(InstrumentationTes
完整回答请参考FAQ: FAQ64348
### 问题: android.app.cts.AlarmManagerTest#testSetTypes 测试FAIL
解决方案: (1)错误堆栈: 04-30 21:43:54.717 5084 5096 I TestRunner: failed: testSetTypes(android.app.cts.AlarmManagerTest) 04-30 21:43:54.717 5084 5096 I TestRunner: ----- begin exception ----- 04-30 21:43:54.727 5084 5096 I TestRunner: 04-30 21:43:54.727 5084 5096 I TestRunner: junit.framework.AssertionFailedError: unexpected timeout 04-30 21:43:54.727 5084 5096 I TestRunner: at junit.framework.Assert.fail(Asser
完整回答请参考FAQ: FAQ64349
### 问题: android.security.cts.ClonedSecureRandomTest#testCheckForDuplicateOutput FAIL
解决方案: (1)测试步骤 run cts –c android.security.cts.ClonedSecureRandomTest –m testCheckForDuplicateOutput (2)测试结果 I/0123456789ABCDEF: android.security.cts.ClonedSecureRandomTest#testCheckForDuplicateOutput FAIL Test failed to run to completion. Reason: 'Failed to receive adb shell test output within 600000 ms. Test may have timed out, or adb connection to device became unresponsive'. Check device logcat for d
完整回答请参考FAQ: FAQ64375
### 问题: CTS测试过程要手动加入VID，为什么其它平台都不需要修改，是否有问题？
解决方案: 看adb的代码:system/core/adb/usb_vendors.c 在usb_vendors_init函数中,首先将builtInVendorIds定义的内置VID加入(之前申请注册过的google社区成员都有固定VID), 然后把$HOME/.android/adb_usb.ini下的一堆VID也加入,展讯的0x1782不再内置VID列表中,所以需要手动加adb_usb.ini,否则连adb shell都进不去: /** built-in vendor list */ int builtInVendorIds[] = { VENDOR_ID_GOOGLE, VENDOR_ID_INTEL, VENDOR_ID_HTC, VENDOR_ID_SAMSUNG, VENDOR_ID_MOTOROLA, VENDOR_ID_HUAWEI, VENDOR_ID_DELL, VENDOR_I
完整回答请参考FAQ: FAQ64376
### 问题: android.telephony.cts.TelephonyManagerTest#testGetDeviceId测试FAIL
解决方案: android.telephony.cts.TelephonyManagerTest#testGetDeviceId这个CASE检查IMEI第15位校验码是否符合规范,测试代码: TelephonyManagerTest.java (cts-kitkat-4.4.4\tests\tests\telephony\src\android\telephony\cts) String deviceId = mTelephonyManager.getDeviceId(); private static void assertImeiCheckDigit(String deviceId) { int expectedCheckDigit = getLuhnCheckDigit(deviceId.substring(0, 14)); int actualCheckDigit = Character.di
完整回答请参考FAQ: FAQ64379
### 问题: CTS测试过程中出现adb掉端口，如何处理？
解决方案: CTS测试过程中,adb掉口后会出现的现象: (1)出现大量未执行(反过来,大量未执行不一定是adb掉口,有很多其它原因); (2)出现单条CASE测试FAIL,后面的CASE仍然正常; (3)每次测试出现很多不同的FAIL:测试过程中出现adb瞬间断开后又连接上,整个测试过程中adb随机断连,FAIL项的位置随机分布; 常规处理方法: (1)USB端口供电电压不稳定:需要排查USB连接线问题、PC端USB口供电电压问题、手机USB接口是否松动、手机USB硬件信号干扰(比如在测试电话、短信类CASE容易出现瞬时断连); 处理:换USB线、换PC、换手机进一步确认掉口现象 (2)软件问题:USB和存储相关修改引入,比如缺省开启MTP模式; 处理:回退软件修改,确认掉口现象 (3)经过1、2仍存在频繁的掉口问题,将slog打开,手机端时间戳和PC端调成一致,同时PC端运行如下脚本: #! /b
完整回答请参考FAQ: FAQ64380
### 问题: CTS测试过程中出现“testCameraFeatures” fail
解决方案: 当使用不带AF功能的sensor模组,并且使用闪光灯的话,需要在camera hal层和framework native层同时做相应的配置修改 1. camera hal层的修改 1.1 自动对焦的修改在vendor/sprd/open-source/libs/libcamera/sc8830/inc/SprdCameraHardwareConfig.h里,添加如下宏定义 #define CONFIG_CAMERA_AUTOFOCUS_NOT_SUPPORT 1.2 闪光灯的配置在对应项目的配置文件BoardConfig.mk里,修改下面配置 TARGET_BOARD_CAMERA_NO_FLASH_DEV :=false 2. framework native层的修改 native层的修改在frameworks/native/data/etc/android.hardware.camer
完整回答请参考FAQ: FAQ64444
### 问题: AndroidL在GTS r2.1测试 com.google.android.webview.xts.WebViewTest 此测项Failed该如何处理？
解决方案: 此com.google.android.webview.xts.WebViewTest测项主要会执行五个检查, 分别为: － testWebViewFrameworkConfigSettingIsSet:检查framework中的config档是否包含com.google.android.webview 宣告 － testWebViewIsSystem:检查系统是否内置WebViewGoogle APK － testWebViewIsPreinstalled:检查系统是否有包含com.google.android.webview这个package name － testWebViewIsSignedWithCorrectKeys:检查内置WebViewGoogle APK 是否含有一组正确的Key值 － testWebViewNativeLibraryIsPresent检查WebViewG
完整回答请参考FAQ: FAQ64682
### 问题: android AsyncTask的使用
解决方案: 1.导入类:import android.os.AsyncTask; 2.如下方法: private TestAsyncTask mTestAsyncTask; private void testAsync() { if (mTestAsyncTask != null && mTestAsyncTask.getStatus() != AsyncTask.Status.FINISHED) { //cancel exsiting task first mTestAsyncTask.cancel(true); } mTestAsyncTask = new TestAsyncTask(); mTestAsyncTask.execute(); } private class TestAsyncTask extends AsyncTask<Void, Void, Void> { @Override p
完整回答请参考FAQ: FAQ65018
### 问题: 分区名称变动时OTA从4.4升级到.5.1时文件打开失败报错
解决方案: 客户遇到这种问题, 可以看一下4.4基础版本的分区, /dev/block/platform/sdio_emmc/by-name/wdsp是不存在的, 应该是/dev/block/platform/sprd-sdhci.3/by-name/wdsp, 在跨大版本升级时,对于分区名称不一致的情况,制作升级包的时候需要加上-C参数. 如果是4.4到5.1的大版本升级,则只能进行ota整包升级,而且编制ota整包升级的时候需要特殊命令: 在make otapakcage动作完成编制出目标版本的target包以后,假定target包的名是B.zip,则接下来用如下命令: ./build/tools/releasetools/ota_from_target_files -HCSR B.zip full_update.zip 其中: -H:用于表示大版本升级 -C:版本间分区名有变化 -S:版本间分区
完整回答请参考FAQ: FAQ70149
### 问题: SC7715，在某些语言下，通话界面由于字符长，UI显示不整齐，如何处理
解决方案: 在某些语言下,通话界面由于字符长,UI显示不整齐,请做以下修改: packages/apps/InCallUI/res/values\styles.xml <style name="IncallImageSprd"> <item name="android:layout_width">wrap_content</item> <item name="android:layout_height">wrap_content</item> <item name="android:layout_gravity">center</item> <item name="android:gravity">center_horizontal|bottom</item> <item name="android:textAlignment">gravity</item> <item name="android:c
完整回答请参考FAQ: FAQ82529
### 问题: 如何去掉下拉状态栏中的数据连接按钮选项？
解决方案: 定位至/frameworks/base/packages/SystemUI/res/values/config.xml文件, 修改前:         <!-- The default tiles to display in QuickSettings -->
    <string name="quick_settings_tiles_default" translatable="false">
        wifi,bt,data,inversion,airplane,lte,rotation,flashlight,location,cast,hotspot
    </string> 修改后:         <!-- The default tiles to display in QuickSettings -->
    <string name="quick_set
完整回答请参考FAQ: FAQ66040
### 问题: 如何在开机完成的时候添加震动
解决方案: frameworks/base/services/java/com/android/server/power/PowerManagerService.java +import android.os.Vibrator; +import android.os.Process; +import android.os.SystemVibrator; private void checkIfBootAnimationFinished() { .... synchronized (mLock) { if (!mBootCompleted) { Slog.i(TAG, "Boot animation finished."); handleBootCompletedLocked(); } } +Vibrator vibrator = new SystemVibrator(); + try { + vibr
完整回答请参考FAQ: FAQ66046
### 问题: android5.1长按关机键，关机菜单界面出现情景模式功能
解决方案: 1.base\core\res\res\values\ <string-array translatable="false" name="config_globalActionsList"> <item>power</item> <item>bugreport</item> <item>users</item> <!-- SPRD: add the reboot --> <item>reboot</item> <!-- SPRD: add airplane button --> <item>airplane</item> <item>silent</item> //增加这个就有情景模式菜单 </string-array> 2.frameworks/base/policysrc/com/android/internal/policy/impl/GlobalActions.java publi
完整回答请参考FAQ: FAQ66073
### 问题: Android 5.0与5.1遇到 android.mediastress.cts 测试的常见问题
解决方案: 一、android 5.0 ctandroid.mediastress.cts fail. 分析如下: 在android 5.0中 mnt/sdcard指向的路径改变为内存,一直在android 4.4以前都习惯将CTS media放置在外置t卡测试.而此时就会因为找不到片源而发生fail. 确认mnt/sdcard指向的路径方法:进入到adb shell里面,在进入到mnt目录下,输入ls -l 或者 ll 来看档案的属性与权限.此时就可以看到sdcard指向的路径.ex: sdcard -> /storage/emulated/legacy . 放置片源最好使用google提供的copy_media.sh脚本放置.使用此脚本的好处就是会直接放置在当前手机 mnt/sdcard指向的路径,可以避免手动放置片源放置错误位置,而让android.mediastress.cts fail的情况
完整回答请参考FAQ: FAQ66910
### 问题: 5.0平台debug版本比user版本多出哪些FAIL？
解决方案: 5.0平台如下测试项,只在debug版本存在: android.security.cts.BannedFilesTest#testNoSu // debug版本存在su进程报错 android.security.cts.BannedFilesTest#testNoSuInPath // debug版本存在su进程报错 android.security.cts.SELinuxTest#testSELinuxPolicyFile // debug版本检测到collect_apr_apr、sprd_res_monitor、slog这三个进程,不能与init在同一Domain android.security.cts.SELinuxHostTest#testAllEnforcing // debug版本SELinux开启的情况下,检测到su进程 android.security.cts.SELin
完整回答请参考FAQ: FAQ65475
### 问题: android.security.cts.SELinuxHostTest#testAllEnforcing测试FAIL
解决方案: PC端的log显示报错信息: android.security.cts.SELinuxHostTest#testAllEnforcing FAIL java.io.IOException: Cannot run program "/tmp/sepolicy-analyze2324859978058616965.tmp": error=2, 没有那个文件或目录 at java.lang.ProcessBuilder.start(ProcessBuilder.java:1047) at android.security.cts.SELinuxHostTest.testAllEnforcing(SELinuxHostTest.java:84) 这个测试CASE先在PC端随机生成/tmp/sepolicy-analyzexxx.tmp可执行文件,然后通过adb shell取出手机端的SELinux
完整回答请参考FAQ: FAQ65491
### 问题: 测试CTS时，出现测到126条中断的问题
解决方案: 从CTS的log可以看到CtsAdminTestCases.apk安装不成功: 06-02 11:56:39 I/D9612C1311800108: ----------------------------------------- 06-02 11:56:39 I/D9612C1311800108: Test package android.admin started 06-02 11:56:39 I/D9612C1311800108: ----------------------------------------- 06-02 11:56:39 D/InstrumentationApkTest: Installing CtsAdminTestCases.apk on D9612C1311800108 06-02 11:56:39 D/CtsAdminTestCases.apk: Up
完整回答请参考FAQ: FAQ65522
### 问题: android.os.cts.BuildVersionTest#testBuildFingerprint FAIL
解决方案: 05-28 16:24:19 I/SDP7F310RN600056: android.os.cts.BuildVersionTest#testBuildFingerprint FAIL junit.framework.ComparisonFailure: expected:<[PSP3503DUO]> but was:<[v120_tmk_0b1]> at android.os.cts.BuildVersionTest.testBuildFingerprint(BuildVersionTest.java:67) fingerprint规则: (BRAND)/(PRODUCT)/(DEVICE):(VERSION.RELEASE)/(BUILD_ID)/(BUILD_NUMBER):(BUILD_VARIANT)/(TAGS) 报错信息是 junit.framework.Comparison
完整回答请参考FAQ: FAQ65577
### 问题: android.animation.cts.ValueAnimatorTest一部分CASE测试失败
解决方案: 从host_log中,看到以下FAIL: 05-13 23:43:07 I/16339025392146: android.animation.cts.AnimatorTest#testIsStarted FAIL 05-13 23:43:12 I/16339025392146: android.animation.cts.LayoutAnimationTest#testIsChangingLayout FAIL 05-13 23:43:14 I/16339025392146: android.animation.cts.LayoutAnimationTest#testIsRunning FAIL 05-13 23:43:29 I/16339025392146: android.animation.cts.PropertyValuesHolderTest#testSetValues FAI
完整回答请参考FAQ: FAQ65580
### 问题: 为何文件管理器无法分享ogg文件到信息
解决方案: 这是因为短信里面没有对ogg文件的type添加相应的intent-filter,需要做如下修改: diff --git a/old/Mms/AndroidManifest.xml b/old/Mms/AndroidManifest.xml index 8bcb302..60a0996 100644 --- a/old/Mms/AndroidManifest.xml +++ b/old/Mms/AndroidManifest.xml @@ -180,6 +180,8 @@ <data android:mimeType="image/*" /> <data android:mimeType="text/x-vcard" /> <data android:mimeType="text/x-vcalendar" /> + <data android:mimeType="application/og
完整回答请参考FAQ: FAQ65892
### 问题: 如何实现wifi连接成功后，自动隐藏状态栏数据连接图标？
解决方案: 如果希望wifi连接成功后,自动隐藏状态栏数据连接图标.只需要在判断wifi已连接后,隐藏数据连接的相关图标即可.具体代码修改参考如下: 打开/frameworks/base/packages/SystemUI/src/com/android/systemui/statusbar/SignalClusterView.java 第一步:我们定义一个全局变量来标记是否开启了该功能: private boolean mShowDataOnlyNoWifi = SystemProperties.getBoolean("show.data.onlynowifi",true); 默认为开启状态,如果不需要该功能,只需在项目的配置文件中配置"show.data.onlynowifi"这个系统属性为false即可. 第二步:在wifi连接状态改变时,需要强制刷新卡1和卡2的数据连接图标,具体如下:    
完整回答请参考FAQ: FAQ65923
### 问题: CTS android.webkit.cts.WebSettingsTest--testUserAgentString_default失败，请问是什么原因
解决方案: 这是由于更新GMS包中的WebViewGoogle引起, CTS要求的 UA pattern: Mozilla/5\.0 \(Linux;( U;)? Android ([^;]+);( (\w+)-(\w+);)?\s?(.*)\sBuild/(.+)\) AppleWebKit/(\d+)\.(\d+) \(KHTML, like Gecko\) Version/\d+\.\d+ Chrome/\d+\.\d+\.\d+\.\d+( Mobile)? Safari/(\d+)\.(\d+) 以上是校验UA的正则表达式, 但是在42.0.2311版本的WebViewGoogle apps 中会返回 "Mozilla/5.0 (Linux; Android 5.1; SP7730A Build/LMY47D; wv) AppleWebKit/537.36 (KHTML, like Geck
完整回答请参考FAQ: FAQ66598
### 问题: 如何优化第一次开机时桌面上widget加载慢的现象？
解决方案: 有时候会发现在第一次开机的时候,会发现桌面上的widget控件需要比较长的一段时间,才能刷新出来.出现这种现象主要是由于第一次开机时,系统后台比较繁忙,消息比较多,导致widget刷新的广播得不到及时处理,影响用户体验. 一个比较简单的优化方案就是将widget的刷新广播设置为前台广播,这样可以确保该广播能及时被处理,具体代码修改如下: 打开/frameworks/base/services/java/com/android/server/AppWidgetServiceImpl.java,在该文件中搜索"ACTION_APPWIDGET_ENABLED"和"ACTION_APPWIDGET_UPDATE"这两个关键字,在发送该广播的时候加上前台广播的标志.具体如下:      void sendEnableIntentLocked(Provider p) {
         Inte
完整回答请参考FAQ: FAQ65928
### 问题: 如何实现锁屏界面日期格式与设置中设置的日期格式一致？
解决方案: 锁屏界面的日期显示时,google默认设计为日期格式会调用getBestDateTimePattern根据当前系统语言获取到最适合当地阅读习惯的日期格式. 但获取到的日期格式可能会与设置中所设置的日期格式不同,如果期望锁屏界面日期格式与设置中设置的日期格式保持完全一致,可按照下面方式修改: 第一步:改造TextClock控件 由于TextClock中显示日期字符串时,用的是应用指定的格式,而非系统设置的格式,因此,需要稍微进行改造,具体如下: 定位到frameworks/base/core/java/android/widget/TextClock.java的onTimeChanged方法中作如下修改:      private void onTimeChanged() {
         mTime.setTimeInMillis(System.currentTimeMillis()
完整回答请参考FAQ: FAQ65930
### 问题: 如何让锁屏界面也可以显示动态壁纸？
解决方案: 平台设计时,考虑到在锁屏界面显示动态壁纸对一些配置较低的机器可能比较吃力,因此,默认设计为:锁屏界面不支持动态壁纸.当系统壁纸设置为动态壁纸时,锁屏界面会获取系统默认的静态壁纸作为背景. 如果期望锁屏界面也可以像系统桌面一样,用动态壁纸作背景,可按照下面方式修改. 定位到\frameworks\base\core\java\android\app\WallpaperManager.java中,为了方便该功能的开启和关闭,我们用一个系统属性来记录该功能是否开启. 第一步:增加必要的头文件,并在Globals类中定义一个全局变量,如下所示: import android.os.SystemProperties; private final boolean mEnableLockScreenLiveWallpaper; 第二步:在Globals类的构造函数中初始化第一步中定义的变量,如下所示: 
完整回答请参考FAQ: FAQ65931
### 问题: 修改了values文件夹下dimens.xml中的某个值，但是不起作用，仍存在布局遮挡问题，这是为什么？
解决方案: 1. 首先要明确android资源文件夹结构,其中有关values的文件夹: values:存放默认的资源文件; values-sw320dp:存放对应屏幕宽于320dp的资源文件; values-sw360dp:存放对应屏幕宽于360dp的资源文件; values-sw400dp:存放对应屏幕宽于400dp的资源文件; (依次类推,备注:160dp = 1英寸) 2. 操作系统会根据当前的屏幕尺寸自动按照相应的路径来搜索资源.以dimens.xml中的keyguard_security_height为例:一个设备宽400dp,则操作系统就会在values-sw400dp的dimens.xml中搜索keyguard_security_height,若找到,则直接匹配使用;若是没有找到,则在values-sw360dp目录下继续搜索,若还是没有找到,则到values-sw320dp目录下搜索
完整回答请参考FAQ: FAQ65983
### 问题: 如何获取手机屏幕的实际物理尺寸
解决方案: 通过开机日志: ************************************************** 06-19 14:05:12.243 I/[Gralloc]( 160): using (fd=17) 06-19 14:05:12.243 I/[Gralloc]( 160): id = sprdfb 06-19 14:05:12.243 I/[Gralloc]( 160): xres = 720 px 06-19 14:05:12.243 I/[Gralloc]( 160): yres = 1280 px 06-19 14:05:12.243 I/[Gralloc]( 160): xres_virtual = 720 px 06-19 14:05:12.243 I/[Gralloc]( 160): yres_virtual = 3840 px 06-19 14:05:1
完整回答请参考FAQ: FAQ65946
### 问题: 如何使SprdLauncher2桌面文件夹内应用图标固定n列显示？
解决方案: 例如:使桌面文件夹内应用图标固定3列显示. 修改如下: 在res/values/config.xml中: - <integer name="folder_max_count_x">4</integer> - <integer name="folder_max_count_y">4</integer> - <integer name="folder_max_num_items">16</integer> + <integer name="folder_max_count_x">3</integer> + <integer name="folder_max_count_y">3</integer> + <integer name="folder_max_num_items">9</integer> 在src/com/android/sprdlauncher2/Folder.java中: pri
完整回答请参考FAQ: FAQ66139
### 问题: 如何实现状态栏仅插入单卡时只显示插入卡的信号并且在未插卡情况下只显示一张未插卡图标？
解决方案: 对于仅在状态栏显示插入SIM卡的信号图标这个需求,实现起来非常简单,FAQ51555中有详细说明,主要原理就是设置状态栏信号图标是否可见时,该信号图标对应的SIM卡是否已插入.仅在插入SIM卡时才设置对应的信号图标为可见状态. 上面的修改会出现一种现象,当两张SIM卡均不插入时,状态栏上无任何未插卡图标.如果期望在这种情况下,需要显示一张未插卡图标,可以按照下面的方案实现,以下为完整修改方案,供参考. 打开\frameworks\base\packages\SystemUI\src\com\android\systemui\statusbar\policy\NetworkController.java这个文件. 第一步: 定义一个全局变量来标识是否开启该功能: private boolean mIsShowMobileIconOnlyHasSIMCard = SystemPropertie
完整回答请参考FAQ: FAQ66596
### 问题: 如何修改使下拉状态栏中wifi图标的显示不出现感叹号？
解决方案: 需要修改两个文件: 1. 定位至/frameworks/base/packages/SystemUI/src/com/android/systemui/statusbar/policy/NetworkControllerImplSprd.java 添加一个静态函数:     public static int getWifiNotConnectedIconId(){
        int inetCondition = inetConditionForNetwork(ConnectivityManager.TYPE_WIFI);
        return WifiIcons.QS_WIFI_SIGNAL_STRENGTH[inetCondition][0];
    }
 并将inetConditionForNetwork()函数修改为静态方法,即: 修改前:     pri
完整回答请参考FAQ: FAQ65993
### 问题: 如何实现正常开机logo与插上充电器开机显示的Logo要不一样
解决方案: logo资源部分 1, 正常开机logo放在BootLogo 2, 插入充电器logo放在Fastbootlogo(目前没有用,正好可以放在此) 代码修改部分 u-boot/property/normal_emc_mode.c +int ischargemode=0; void vlx_nand_boot(char * kernel_pname, char * cmdline, int backlight_set) { dev = get_dev("mmc", 1); if(NULL == dev){ debugf("Fatal Error,get_dev mmc failed!\n"); return; } + if (strstr (cmdline, "androidboot.mode=charger") == NULL) + ischargemode=0 ; //正常模式 + els
完整回答请参考FAQ: FAQ66074
### 问题: 如何隐式跨进程启动Actiivty
解决方案: 众所周知,Activity的启动有两种方式:显示和隐式,显示就是直接启动指定的class,隐式就是通过intent的action,让系统自己去筛选适合此action的Activity,如果有多个可以处理此action,则弹出对话框供用户选择,其实这个就已经包括跨进程启动Activity,那么如何做到的? 例如:有两个应用A和B,要让A来启动B中的Activity,则必须: 1. A中定义Intent的Action必须与B中AndroidManifest.xml中Activity注册的intent-filter相同 2. B中AndroidManifest.xml中Activity必须加上<category android:name="android.intent.category.DEFAULT"/> 3. B必须已经安装完成或后台运行 这样在A中通过startActivity(inten
完整回答请参考FAQ: FAQ66097
### 问题: 通话中手机灭屏，对方挂断后测试机不会亮起
解决方案: google原生自始至终的版本都没有做入此功能, 挂断后亮屏无疑是增加系统power负担. 如需修改,参考修改如下: diff --git a/src/com/android/phone/PhoneGlobals.java b/src/com/android/phone/PhoneGlobals.java index 4aa597e..71448a5 100644 --- a/src/com/android/phone/PhoneGlobals.java +++ b/src/com/android/phone/PhoneGlobals.java @@ -675,7 +675,7 @@ public class PhoneGlobals extends ContextWrapper { * If we are not currently keeping the screen on, then
完整回答请参考FAQ: FAQ66123
### 问题: 如何修改AllApp列表中app icon下面的文字颜色？
解决方案: 例如:将AllApp列表中app icon下面的文字颜色改成白色. 修改如下: res/values/Colors.xml + <color name="quantum_allapp_panel_text_color">#FFFFFFFF</color> res/values/Styles.xml <style name="WorkspaceIcon.AppsCustomize"> <item name="android:background">@null</item> - <item name="android:textColor">@color/quantum_panel_text_color</item> + <item name="android:textColor">@color/quantum_allapp_panel_text_color</item> <item name=
完整回答请参考FAQ: FAQ66135
### 问题: 如何使原生Launcher3的字体大小不随设置中字体改变而改变？
解决方案: 在Launcher3/src/com/android/launcher3/LauncherApplication.java中加入如下修改即可. public class LauncherApplication extends Application {

+    static final float LAUNCHER_FONT_SIZE = 1.0f;
+    private final Configuration mCurConfig = new Configuration();

    @Override
    public void onCreate() {
        super.onCreate();
+        checkForConfigChanges();
        LauncherAppState.setApplicationCo
完整回答请参考FAQ: FAQ66179
### 问题: 如何指定launcher主菜单中的应用排列顺序？
解决方案: 以Launcher3为例: 在Launcher3/src/com/android/launcher3/Utilities.java中加入如下修改: +import java.util.Arrays;
+import java.util.List;

+    public static List<String> getAppsComponentName(final Context context) {
+        return Arrays.asList(context.getResources().getStringArray(R.array.apps_componentName));
+    } 在Launcher3/src/com/android/launcher3/AppsCustomizePagedView.java中加入如下修改:     public voi
完整回答请参考FAQ: FAQ66182
### 问题: 如何修改Launcher3桌面文件夹内应用图标和应用图标下应用名的距离？
解决方案: 例如:设置桌面文件夹内应用图标和应用图标下应用名的距离为4dp res/values/Styles.xml : <style name="WorkspaceIcon"> <item name="android:layout_width">match_parent</item> <item name="android:layout_height">match_parent</item> <item name="android:layout_gravity">center</item> <item name="android:gravity">center_horizontal</item> <item name="android:singleLine">true</item> <item name="android:ellipsize">marquee</item> + <item name
完整回答请参考FAQ: FAQ66195
### 问题: 怎么从aplog看当前cp上报的网络注册情况
解决方案: 关注下面gsm模块打印的log 里的regState ,TS 27.007 7.2 log("handlPollStateResultMessage: GmSST setDataRegState=" + dataRegState + " regState=" + regState + " dataRadioTechnology=" + type); circuit mode registration status 0 not registered, MT is not currently searching a new operator to register to 1 registered, home network 2 not registered, but MT is currently searching a new operator to register to 3 regist
完整回答请参考FAQ: FAQ66200
### 问题: 为什么修改了当前工程的strings.xml中的字符串内容，但是手机上显示的对应字符串没有改变？
解决方案: 因为对于定制的手机而言,在加载了源码的资源之后还会加载定制商的资源文件,若后者的strings.xml存在与前者strings.xml中相同的name属性,则手机最终显示的字符串内容为后者strings.xml中对应name属性的内容. 以keyguard模块为例来说明该问题: 1. /idh.code/frameworks/base/packages/Keyguard/res/values-zh-rCN/strings.xml 修改前: <string name="keyguard_missing_sim_message_short" msgid="494980561304211931">"未插卡"</string> 修改后: <string name="keyguard_missing_sim_message_short" msgid="494980561304211931">"没有S
完整回答请参考FAQ: FAQ66286
### 问题: 如何将锁屏界面的运营商信息显示在屏幕下方的位置（紧急呼叫的上面）？
解决方案: 这里要修改两个文件: 1. 将/frameworks/base/packages/SystemUI/res/layout/keyguard_status_bar.xml 中的 <com.sprd.keyguard.CarriersTextLayout
        android:layout_below="@id/keyguard_header_layout"
        android:layout_alignParentBottom= "true"
        android:layout_marginTop = "-10dp"
        android:id="@+id/carriers_layout"
        android:orientation="vertical"
        android:gravity="center_horiz
完整回答请参考FAQ: FAQ66287
